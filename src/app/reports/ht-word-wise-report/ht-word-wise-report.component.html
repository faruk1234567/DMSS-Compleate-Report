<div class="container-fluid px-3 px-md-4">
  <div class="card shadow-lg mb-4 rounded-3 border-0">
  <div class="card-header bg-dark text-white py-3 px-4 d-flex align-items-center justify-content-between rounded-top-3"> <h2 class="h5 mb-0 fw-bold"><i class="bi bi-file-earmark-text-fill me-2"></i>ওয়ার্ড ভিত্তিক হোল্ডিং ট্যাক্স আদায় রিপোর্ট</h2>
  </div>
  <div class="card-body p-4">
    <form (ngSubmit)="getHtaxWordReport()" #reportForm="ngForm" class="row g-4 align-items-end">
      <div class="col-12 col-sm-6 col-md-3">
        <label for="municipalityId" class="form-label mb-2 fw-semibold text-dark">পৌরসভা আইডি:</label> <input type="number" class="form-control form-control-lg rounded-pill border-dark" id="municipalityId" name="municipalityId" [(ngModel)]="formData.municipalityId" required /> <div *ngIf="reportForm.controls['municipalityId']?.invalid && reportForm.controls['municipalityId']?.touched" class="text-danger small mt-1">
          পৌরসভা আইডি প্রয়োজন।
        </div>
      </div>

      <div class="col-12 col-sm-6 col-md-3">
        <label for="startDate" class="form-label mb-2 fw-semibold text-dark">শুরুর তারিখ:</label> <div class="input-group input-group-lg rounded-pill overflow-hidden">
          <input type="date" class="form-control border-dark border-end-0" id="startDate" name="startDate" [(ngModel)]="formData.startDate" required /> <span class="input-group-text bg-white border-dark border-start-0 text-primary"> <i class="bi bi-calendar-date fs-5"></i>
          </span>
        </div>
        <div *ngIf="reportForm.controls['startDate']?.invalid && reportForm.controls['startDate']?.touched" class="text-danger small mt-1">
          শুরুর তারিখ প্রয়োজন।
        </div>
      </div>

      <div class="col-12 col-sm-6 col-md-3">
        <label for="endDate" class="form-label mb-2 fw-semibold text-dark">শেষের তারিখ:</label> <div class="input-group input-group-lg rounded-pill overflow-hidden">
          <input type="date" class="form-control border-dark border-end-0" id="endDate" name="endDate" [(ngModel)]="formData.endDate" required /> <span class="input-group-text bg-white border-dark border-start-0 text-primary"> <i class="bi bi-calendar-date fs-5"></i>
          </span>
        </div>
        <div class="text-danger small mt-1" *ngIf="reportForm.controls['endDate']?.invalid && reportForm.controls['endDate']?.touched">
          শেষের তারিখ প্রয়োজন।
        </div>
      </div>

      <div class="col-12 col-sm-6 col-md-3 d-flex align-items-end">
        <button type="submit" class="btn btn-dark btn-lg flex-grow-1 shadow-sm rounded-pill" [disabled]="!reportForm.form.valid"> <i class="bi bi-search me-2"></i> রিপোর্ট দেখুন
        </button>
      </div>
    </form>
  </div>
</div>

  <div class="card shadow-sm mb-4" *ngIf="showReport">
    <div class="card-body py-3">
      <div class="row g-3 align-items-center">
        <div class="col-12 col-md-6">
          <label for="searchHoldingNo" class="form-label mb-1">ওয়ার্ড নং দিয়ে সার্চ করুন:</label>
          <input
            type="text"
            class="form-control form-control-sm"
            id="searchWordNo"
            name="searchWordNo"
            [(ngModel)]="formData.searchWordNo"
            (input)="onSearchWordNoChange()"
            placeholder="ওয়ার্ড নম্বর লিখুন..."
          />
        </div>
      </div>
    </div>
  </div>

 <div class="card shadow-sm mb-4" *ngIf="showReport">
  <div class="card-header bg-info text-white py-2 custom-card-header d-flex justify-content-between align-items-center">
    <h2 class="h5 mb-0">রিপোর্টের তথ্য</h2>
    <!-- <div class="d-flex">
      <button class="btn btn-light btn-sm me-2" (click)="downloadExcel()" [disabled]="!reportData || reportData.length === 0">
        <i class="bi bi-file-earmark-excel me-1"></i> Excel ডাউনলোড
      </button>
      <button class="btn btn-light btn-sm" (click)="downloadCsv()" [disabled]="!reportData || reportData.length === 0">
        <i class="bi bi-file-earmark-spreadsheet me-1"></i> CSV ডাউনলোড
      </button>
      
      </div>-->
  </div> 
  

  <div class="card-body p-0">
    <div class="table-responsive table-container-scroll">
      <table class="table table-striped table-bordered table-hover mb-0">
        <thead class="sticky-top-table-header">
          <tr>
            <th>ওয়ার্ড নম্বর</th>
            <th>বিল সংখ্যা</th>
            <th>বকেয়া</th>
            <th>হাল</th>
            <th>মোট</th>
            <th>সারচার্জ</th>
            <th>রিবেট</th>
            <th>শুধু বকেয়া</th>
           </tr>
        </thead>
        <tbody>
          <ng-container *ngIf="reportData && reportData.length > 0; else noData">
            <tr *ngFor="let item of reportData">
              <td>{{ item.wardNo }}</td>
              <td>{{ item.totalHoldingsInWard }}</td>
              <td>{{ item.totalUnpaidBill }}</td>
              <td>{{ item.totalHal }}</td>
              <td>{{ item.grandTotalPaidMoney }}</td>
              <td>{{ item.totalSurcharge }}</td>
              <td>{{ item.totalRebet }}</td>
              <td>{{ item.onlyBokeyaSum }}</td>
             
            </tr>
          </ng-container>
          <ng-template #noData>
            <tr>
              <td colspan="18" class="text-center p-4 text-danger">
                কোনো ডেটা পাওয়া যায়নি। ডেটা দেখতে উপরের ফর্ম পূরণ করে "রিপোর্ট দেখুন" বাটনে ক্লিক করুন।
              </td>
            </tr>
          </ng-template>
        </tbody>
       <!--  <tfoot *ngIf="reportData && reportData.length > 0">
          <tr>
            <td class="fw-bold ps-3">Total:</td>
            <td class="fw-bolder fs-5 pe-3">{{getTotalHoldingNoCount()}}</td>
            <td></td>
            <td class="fw-bolder fs-5 pe-3">{{getUnpaidBill() }}</td>
            <td class="fw-bolder fs-5 pe-3">{{getSurcharge() }}</td>
            <td class="fw-bolder fs-5 pe-3">{{getDueHolding() }}</td>
            <td class="fw-bolder fs-5 pe-3">{{getDueConsevency() }}</td>
            <td class="fw-bolder fs-5 pe-3">{{getDueElectriCity() }}</td>
            <td class="fw-bolder fs-5 pe-3">{{ getDueWater() }}</td>
            <td class="fw-bolder fs-5 pe-3">{{getTotalTotalBill() }}</td>
            <td class="fw-bolder fs-5 pe-3">{{ getCurrentHolding() }}</td>
            <td class="fw-bolder fs-5 pe-3">{{ getCurrentConsevency() }}</td>
            <td class="fw-bolder fs-5 pe-3">{{ getCurrentElectriCity() }}</td>
            <td class="fw-bolder fs-5 pe-3">{{ getCurrentWater() }}</td>
            <td class="fw-bolder fs-5 pe-3">{{ getTotalRebet() }}</td>
            <td class="fw-bolder fs-5 pe-3">{{ getTotalGetNetBill() }}</td>
            <td class="fw-bolder fs-5 pe-3">{{ getTotalPaidMoney() }}</td>
          </tr>
        </tfoot> -->
      </table>
    </div>
  </div>
</div>
</div>